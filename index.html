<html lang="es">
<head>
  <meta charset="UTF-8"></meta>
  <title>Talismán de Aarón</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.2/p5.min.js"></script>
  <style>
    body { margin: 0; display: flex; justify-content: center; align-items: center; background: white; }
    canvas { display: block; }
  </style>
</head>
<body>
<script>
let largeDisc, smallDisc;
let largeAngle = 0;
let smallAngle = 0;
let draggingLarge = false;
let draggingSmall = false;
let lastMousePos = null;
const ROTATION_SPEED = 2;

function preload() {
  // Cargar imágenes desde Imgur
  try {
    largeDisc = loadImage('Grande.gif');
    smallDisc = loadImage('pequeño.gif');
  } catch (e) {
    console.log("Error cargando imágenes, usando placeholders");
    largeDisc = createGraphics(645, 614);
    largeDisc.fill(200, 200, 200, 128);
    largeDisc.ellipse(645/2, 614/2, 645, 614);
    smallDisc = createGraphics(328, 319);
    smallDisc.fill(150, 150, 150, 128);
    smallDisc.ellipse(328/2, 319/2, 328, 319);
  }
}

function setup() {
  createCanvas(700, 700);
  // Escalar imágenes al tamaño correcto
  if (largeDisc) largeDisc.resize(645, 614);
  if (smallDisc) smallDisc.resize(328, 319);
  textSize(20);
  textFont('Arial');
}

function draw() {
  background(255); // Fondo blanco

  // Rotación con teclado (suave)
  if (keyIsDown(65)) largeAngle += ROTATION_SPEED; // Tecla A
  if (keyIsDown(68)) largeAngle -= ROTATION_SPEED; // Tecla D
  if (keyIsDown(LEFT_ARROW)) smallAngle += ROTATION_SPEED;
  if (keyIsDown(RIGHT_ARROW)) smallAngle -= ROTATION_SPEED;

  // Dibujar disco grande
  push();
  translate(width / 2, height / 2);
  rotate(radians(largeAngle));
  if (largeDisc) {
    image(largeDisc, -645 / 2, -614 / 2, 645, 614);
  } else {
    fill(200, 200, 200, 128);
    ellipse(0, 0, 645, 614);
  }
  pop();

  // Dibujar disco pequeño (desplazado 15 píxeles hacia abajo)
  push();
  translate(width / 2, height / 2 + 15);
  rotate(radians(smallAngle));
  if (smallDisc) {
    image(smallDisc, -328 / 2, -319 / 2, 328, 319);
  } else {
    fill(150, 150, 150, 128);
    ellipse(0, 0, 328, 319);
  }
  pop();

  // Mostrar ángulos
  fill(0);
  text(`Disco Grande: ${int(largeAngle % 360)}°`, 10, 30);
  text(`Disco Pequeño: ${int(smallAngle % 360)}°`, 10, 60);
}

function mousePressed() {
  let mousePos = createVector(mouseX, mouseY);
  let center = createVector(width / 2, height / 2);
  let dist = mousePos.dist(center);
  if (mouseButton === LEFT && dist < 645 / 2) {
    draggingLarge = true;
    lastMousePos = mousePos;
  } else if (mouseButton === RIGHT && dist < 328 / 2) {
    draggingSmall = true;
    lastMousePos = mousePos;
  }
}

function mouseReleased() {
  draggingLarge = false;
  draggingSmall = false;
  lastMousePos = null;
}

function mouseDragged() {
  if (draggingLarge || draggingSmall) {
    let currentPos = createVector(mouseX, mouseY);
    let center = createVector(width / 2, height / 2);
    let lastVector = p5.Vector.sub(lastMousePos, center);
    let currentVector = p5.Vector.sub(currentPos, center);
    let angleDiff = degrees(currentVector.heading() - lastVector.heading());
    if (draggingLarge) {
      largeAngle -= angleDiff;
    } else if (draggingSmall) {
      smallAngle -= angleDiff;
    }
    lastMousePos = currentPos;
  }
}

function keyPressed() {
  if (keyCode === 65) largeAngle += 45; // A: 45° izquierda
  if (keyCode === 68) largeAngle -= 45; // D: 45° derecha
  if (keyCode === LEFT_ARROW) smallAngle += 45;
  if (keyCode === RIGHT_ARROW) smallAngle -= 45;
}
</script>
</body>
</html>

